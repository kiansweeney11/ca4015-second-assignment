
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KNN Impute Experiments &#8212; CA4015 Assignment 2</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Firstly, let’s load in our data and convert to CSV" href="automl.html" />
    <link rel="prev" title="CA4015 Assignment 2" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">CA4015 Assignment 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   CA4015 Assignment 2
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   KNN Impute Experiments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="automl.html">
   Firstly, let’s load in our data and convert to CSV
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/data-processing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kiansweeney11/ca4015-second-assignment"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kiansweeney11/ca4015-second-assignment/issues/new?title=Issue%20on%20page%20%2Fdata-processing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kiansweeney11/ca4015-second-assignment/master?urlpath=tree/data-processing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   KNN Impute Experiments
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#actual-tests-nan-present">
   Actual Tests NaN present
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-forest-classifier">
   Random Forest Classifier
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rf-for-strain-at-20-split">
     RF for Strain at 20% Split
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split">
     10% Split
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     40%
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     50% Split
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     25% Split
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     30% Split
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">ExcelWriter</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">ExcelFile</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">supervised.automl</span> <span class="kn">import</span> <span class="n">AutoML</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_27132</span><span class="o">/</span><span class="mf">3999718835.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">supervised.automl</span> <span class="kn">import</span> <span class="n">AutoML</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;supervised&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/FrontiersDS.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Wide&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/FrontiersDS.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Long&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
      <th>...</th>
      <th>Unnamed: 60</th>
      <th>Unnamed: 61</th>
      <th>Unnamed: 62</th>
      <th>Unnamed: 63</th>
      <th>Unnamed: 64</th>
      <th>Unnamed: 65</th>
      <th>Unnamed: 66</th>
      <th>Unnamed: 67</th>
      <th>Unnamed: 68</th>
      <th>Unnamed: 69</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The data in this sheet was used for the formul...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Species</td>
      <td>Strain</td>
      <td>Samples</td>
      <td>Ethyl Acetate</td>
      <td>Ethanol</td>
      <td>Propanoic acid, ethyl ester</td>
      <td>2-Pentanone</td>
      <td>Decane</td>
      <td>Methyl Isobutyl Ketone</td>
      <td>Amylene hydrate</td>
      <td>...</td>
      <td>1-Dodecanol</td>
      <td>Methyl tetradecanoate</td>
      <td>2-Pentadecanone</td>
      <td>Tetradecanoic acid, ethyl ester</td>
      <td>Hexadecanal</td>
      <td>n-Tridecan-1-ol</td>
      <td>1-Tetradecanol</td>
      <td>n-Pentadecanol</td>
      <td>1-Hexadecanol</td>
      <td>Indole</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">headings</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">headings</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">z</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Strain</th>
      <th>Samples</th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The data in this sheet was used for the formul...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Species</td>
      <td>Strain</td>
      <td>Samples</td>
      <td>Ethyl Acetate</td>
      <td>Ethanol</td>
      <td>Propanoic acid, ethyl ester</td>
      <td>2-Pentanone</td>
      <td>Decane</td>
      <td>Methyl Isobutyl Ketone</td>
      <td>Amylene hydrate</td>
      <td>...</td>
      <td>1-Dodecanol</td>
      <td>Methyl tetradecanoate</td>
      <td>2-Pentadecanone</td>
      <td>Tetradecanoic acid, ethyl ester</td>
      <td>Hexadecanal</td>
      <td>n-Tridecan-1-ol</td>
      <td>1-Tetradecanol</td>
      <td>n-Pentadecanol</td>
      <td>1-Hexadecanol</td>
      <td>Indole</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># forgot to remove a row</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Strain</th>
      <th>Samples</th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_C</td>
      <td>403286</td>
      <td>1850391</td>
      <td>NaN</td>
      <td>1169501</td>
      <td>15</td>
      <td>228163</td>
      <td>73558</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_D</td>
      <td>129833</td>
      <td>5140770</td>
      <td>NaN</td>
      <td>1926072</td>
      <td>124282</td>
      <td>0</td>
      <td>188367</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_E</td>
      <td>117105</td>
      <td>3422557</td>
      <td>NaN</td>
      <td>246751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
      <th>...</th>
      <th>Unnamed: 78</th>
      <th>Unnamed: 79</th>
      <th>Unnamed: 80</th>
      <th>Unnamed: 81</th>
      <th>Unnamed: 82</th>
      <th>Unnamed: 83</th>
      <th>Unnamed: 84</th>
      <th>Unnamed: 85</th>
      <th>Unnamed: 86</th>
      <th>Unnamed: 87</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Compounds</td>
      <td>Chemical_class</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SA.A_TSB_A</td>
      <td>SA.A_TSB_B</td>
      <td>SA.A_TSB_C</td>
      <td>SA.A_TSB_D</td>
      <td>SA.A_TSB_E</td>
      <td>SA.B_TSB_A</td>
      <td>...</td>
      <td>EC.A_TSB_A</td>
      <td>EC.A_TSB_B</td>
      <td>EC.A_TSB_C</td>
      <td>EC.A_TSB_D</td>
      <td>EC.A_TSB_E</td>
      <td>EC.B_TSB_A</td>
      <td>EC.B_TSB_B</td>
      <td>EC.B_TSB_C</td>
      <td>EC.B_TSB_D</td>
      <td>EC.B_TSB_E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">headings2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">w</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">headings2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">data2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">w</span>
<span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Compounds</td>
      <td>Chemical_class</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SA.A_TSB_A</td>
      <td>SA.A_TSB_B</td>
      <td>SA.A_TSB_C</td>
      <td>SA.A_TSB_D</td>
      <td>SA.A_TSB_E</td>
      <td>SA.B_TSB_A</td>
      <td>...</td>
      <td>EC.A_TSB_A</td>
      <td>EC.A_TSB_B</td>
      <td>EC.A_TSB_C</td>
      <td>EC.A_TSB_D</td>
      <td>EC.A_TSB_E</td>
      <td>EC.B_TSB_A</td>
      <td>EC.B_TSB_B</td>
      <td>EC.B_TSB_C</td>
      <td>EC.B_TSB_D</td>
      <td>EC.B_TSB_E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Compounds</td>
      <td>Chemical_class</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SA.A_TSB_A</td>
      <td>SA.A_TSB_B</td>
      <td>SA.A_TSB_C</td>
      <td>SA.A_TSB_D</td>
      <td>SA.A_TSB_E</td>
      <td>SA.B_TSB_A</td>
      <td>...</td>
      <td>EC.A_TSB_A</td>
      <td>EC.A_TSB_B</td>
      <td>EC.A_TSB_C</td>
      <td>EC.A_TSB_D</td>
      <td>EC.A_TSB_E</td>
      <td>EC.B_TSB_A</td>
      <td>EC.B_TSB_B</td>
      <td>EC.B_TSB_C</td>
      <td>EC.B_TSB_D</td>
      <td>EC.B_TSB_E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2-Pentanone</td>
      <td>Ketone</td>
      <td>981±11 (141)</td>
      <td>43.0</td>
      <td>1289650</td>
      <td>504113</td>
      <td>1169501</td>
      <td>1926072</td>
      <td>246751</td>
      <td>560337</td>
      <td>...</td>
      <td>673781</td>
      <td>592162</td>
      <td>468142</td>
      <td>559183</td>
      <td>1225829</td>
      <td>169495</td>
      <td>359499</td>
      <td>875905</td>
      <td>637563</td>
      <td>2988409</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2-Pentanone</td>
      <td>Ketone</td>
      <td>981±11 (141)</td>
      <td>43.0</td>
      <td>1289650</td>
      <td>504113</td>
      <td>1169501</td>
      <td>1926072</td>
      <td>246751</td>
      <td>560337</td>
      <td>...</td>
      <td>673781</td>
      <td>592162</td>
      <td>468142</td>
      <td>559183</td>
      <td>1225829</td>
      <td>169495</td>
      <td>359499</td>
      <td>875905</td>
      <td>637563</td>
      <td>2988409</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Decane</td>
      <td>Alkane</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>800581</td>
      <td>294680</td>
      <td>15</td>
      <td>124282</td>
      <td>0</td>
      <td>456376</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>348154</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>NaN</th>
      <th>NaN</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2-Pentanone</td>
      <td>Ketone</td>
      <td>981±11 (141)</td>
      <td>43.0</td>
      <td>1289650</td>
      <td>504113</td>
      <td>1169501</td>
      <td>1926072</td>
      <td>246751</td>
      <td>560337</td>
      <td>...</td>
      <td>673781</td>
      <td>592162</td>
      <td>468142</td>
      <td>559183</td>
      <td>1225829</td>
      <td>169495</td>
      <td>359499</td>
      <td>875905</td>
      <td>637563</td>
      <td>2988409</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Decane</td>
      <td>Alkane</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>800581</td>
      <td>294680</td>
      <td>15</td>
      <td>124282</td>
      <td>0</td>
      <td>456376</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>348154</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64</th>
      <td>n-Tridecan-1-ol</td>
      <td>Alcohol</td>
      <td>2074±20</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>65</th>
      <td>1-Tetradecanol</td>
      <td>Alcohol</td>
      <td>2165±10 (27)</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>851004</td>
      <td>922978</td>
      <td>593032</td>
      <td>450711</td>
      <td>843660</td>
      <td>0</td>
      <td>78672</td>
      <td>84426</td>
      <td>146349</td>
      <td>635257</td>
    </tr>
    <tr>
      <th>66</th>
      <td>n-Pentadecanol</td>
      <td>Alcohol</td>
      <td>2254±15</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>67</th>
      <td>1-Hexadecanol</td>
      <td>Alcohol</td>
      <td>2382±5 (49)</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>850885</td>
      <td>1183943</td>
      <td>382201</td>
      <td>390122</td>
      <td>1033300</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>482026</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Indole</td>
      <td>Indole</td>
      <td>2445±10 (46)</td>
      <td>117.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>88277609</td>
      <td>91230943</td>
      <td>109912287</td>
      <td>89285823</td>
      <td>82182776</td>
      <td>60325589</td>
      <td>107880324</td>
      <td>72102392</td>
      <td>85257546</td>
      <td>97156549</td>
    </tr>
  </tbody>
</table>
<p>67 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span> <span class="s1">&#39;CI&#39;</span><span class="p">})</span>
<span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>CI</th>
      <th>NaN</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2-Pentanone</td>
      <td>Ketone</td>
      <td>981±11 (141)</td>
      <td>43.0</td>
      <td>1289650</td>
      <td>504113</td>
      <td>1169501</td>
      <td>1926072</td>
      <td>246751</td>
      <td>560337</td>
      <td>...</td>
      <td>673781</td>
      <td>592162</td>
      <td>468142</td>
      <td>559183</td>
      <td>1225829</td>
      <td>169495</td>
      <td>359499</td>
      <td>875905</td>
      <td>637563</td>
      <td>2988409</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Decane</td>
      <td>Alkane</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>800581</td>
      <td>294680</td>
      <td>15</td>
      <td>124282</td>
      <td>0</td>
      <td>456376</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>348154</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([     &#39;Compounds&#39;, &#39;Chemical_class&#39;,             &#39;CI&#39;,              nan,
           &#39;SA.A_TSB_A&#39;,     &#39;SA.A_TSB_B&#39;,     &#39;SA.A_TSB_C&#39;,     &#39;SA.A_TSB_D&#39;,
           &#39;SA.A_TSB_E&#39;,     &#39;SA.B_TSB_A&#39;,     &#39;SA.B_TSB_B&#39;,     &#39;SA.B_TSB_C&#39;,
           &#39;SA.B_TSB_D&#39;,     &#39;SA.B_TSB_E&#39;,     &#39;SA.A_BHI_A&#39;,     &#39;SA.A_BHI_B&#39;,
           &#39;SA.A_BHI_C&#39;,     &#39;SA.A_BHI_D&#39;,     &#39;SA.A_BHI_E&#39;,     &#39;SA.B_BHI_A&#39;,
           &#39;SA.B_BHI_B&#39;,     &#39;SA.B_BHI_C&#39;,     &#39;SA.B_BHI_D&#39;,     &#39;SA.B_BHI_E&#39;,
            &#39;SA.A_LB_A&#39;,      &#39;SA.A_LB_B&#39;,      &#39;SA.A_LB_C&#39;,      &#39;SA.A_LB_D&#39;,
            &#39;SA.A_LB_E&#39;,      &#39;SA.B_LB_A&#39;,      &#39;SA.B_LB_B&#39;,      &#39;SA.B_LB_C&#39;,
            &#39;SA.B_LB_D&#39;,      &#39;SA.B_LB_E&#39;,     &#39;PA.A_BHI_A&#39;,     &#39;PA.A_BHI_B&#39;,
           &#39;PA.A_BHI_C&#39;,     &#39;PA.A_BHI_D&#39;,     &#39;PA.A_BHI_E&#39;,     &#39;PA.B_BHI_A&#39;,
           &#39;PA.B_BHI_B&#39;,     &#39;PA.B_BHI_C&#39;,     &#39;PA.B_BHI_D&#39;,     &#39;PA.B_BHI_E&#39;,
            &#39;PA.A_LB_A&#39;,      &#39;PA.A_LB_B&#39;,      &#39;PA.A_LB_C&#39;,      &#39;PA.A_LB_D&#39;,
            &#39;PA.A_LB_E&#39;,      &#39;PA.B_LB_A&#39;,      &#39;PA.B_LB_B&#39;,      &#39;PA.B_LB_C&#39;,
            &#39;PA.B_LB_D&#39;,      &#39;PA.B_LB_E&#39;,     &#39;PA.A_TSB_A&#39;,     &#39;PA.A_TSB_B&#39;,
           &#39;PA.A_TSB_C&#39;,     &#39;PA.A_TSB_D&#39;,     &#39;PA.B_TSB_A&#39;,     &#39;PA.B_TSB_B&#39;,
           &#39;PA.B_TSB_C&#39;,     &#39;EC.A_BHI_A&#39;,     &#39;EC.A_BHI_B&#39;,     &#39;EC.A_BHI_C&#39;,
           &#39;EC.A_BHI_D&#39;,     &#39;EC.B_BHI_A&#39;,     &#39;EC.B_BHI_B&#39;,     &#39;EC.B_BHI_C&#39;,
            &#39;EC.A_LB_A&#39;,      &#39;EC.A_LB_B&#39;,      &#39;EC.A_LB_C&#39;,      &#39;EC.A_LB_D&#39;,
            &#39;EC.A_LB_E&#39;,      &#39;EC.B_LB_A&#39;,      &#39;EC.B_LB_B&#39;,      &#39;EC.B_LB_C&#39;,
            &#39;EC.B_LB_D&#39;,      &#39;EC.B_LB_E&#39;,     &#39;EC.A_TSB_A&#39;,     &#39;EC.A_TSB_B&#39;,
           &#39;EC.A_TSB_C&#39;,     &#39;EC.A_TSB_D&#39;,     &#39;EC.A_TSB_E&#39;,     &#39;EC.B_TSB_A&#39;,
           &#39;EC.B_TSB_B&#39;,     &#39;EC.B_TSB_C&#39;,     &#39;EC.B_TSB_D&#39;,     &#39;EC.B_TSB_E&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;SD&#39;</span><span class="p">)</span>
<span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Compounds</th>
      <th>Chemical_class</th>
      <th>CI</th>
      <th>SD</th>
      <th>SA.A_TSB_A</th>
      <th>SA.A_TSB_B</th>
      <th>SA.A_TSB_C</th>
      <th>SA.A_TSB_D</th>
      <th>SA.A_TSB_E</th>
      <th>SA.B_TSB_A</th>
      <th>...</th>
      <th>EC.A_TSB_A</th>
      <th>EC.A_TSB_B</th>
      <th>EC.A_TSB_C</th>
      <th>EC.A_TSB_D</th>
      <th>EC.A_TSB_E</th>
      <th>EC.B_TSB_A</th>
      <th>EC.B_TSB_B</th>
      <th>EC.B_TSB_C</th>
      <th>EC.B_TSB_D</th>
      <th>EC.B_TSB_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Ethyl Acetate</td>
      <td>Ester</td>
      <td>888±8 (234)</td>
      <td>43.0</td>
      <td>465374</td>
      <td>193151</td>
      <td>403286</td>
      <td>129833</td>
      <td>117105</td>
      <td>316764</td>
      <td>...</td>
      <td>887825</td>
      <td>670603</td>
      <td>576884</td>
      <td>636851</td>
      <td>NaN</td>
      <td>119313</td>
      <td>128397</td>
      <td>309004</td>
      <td>548442</td>
      <td>339404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ethanol</td>
      <td>Alcohol</td>
      <td>932±8 (</td>
      <td>45.0</td>
      <td>1027715</td>
      <td>1050974</td>
      <td>1850391</td>
      <td>5140770</td>
      <td>3422557</td>
      <td>914667</td>
      <td>...</td>
      <td>7585417</td>
      <td>7461659</td>
      <td>2372532</td>
      <td>5114072</td>
      <td>7870420</td>
      <td>1364553</td>
      <td>1451138</td>
      <td>5650813</td>
      <td>3588158</td>
      <td>3962927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Propanoic acid, ethyl ester</td>
      <td>Fatty acid ethyl ester</td>
      <td>953±7 (87)</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2-Pentanone</td>
      <td>Ketone</td>
      <td>981±11 (141)</td>
      <td>43.0</td>
      <td>1289650</td>
      <td>504113</td>
      <td>1169501</td>
      <td>1926072</td>
      <td>246751</td>
      <td>560337</td>
      <td>...</td>
      <td>673781</td>
      <td>592162</td>
      <td>468142</td>
      <td>559183</td>
      <td>1225829</td>
      <td>169495</td>
      <td>359499</td>
      <td>875905</td>
      <td>637563</td>
      <td>2988409</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Decane</td>
      <td>Alkane</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>800581</td>
      <td>294680</td>
      <td>15</td>
      <td>124282</td>
      <td>0</td>
      <td>456376</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>348154</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Strain</th>
      <th>Samples</th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_C</td>
      <td>403286</td>
      <td>1850391</td>
      <td>NaN</td>
      <td>1169501</td>
      <td>15</td>
      <td>228163</td>
      <td>73558</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_D</td>
      <td>129833</td>
      <td>5140770</td>
      <td>NaN</td>
      <td>1926072</td>
      <td>124282</td>
      <td>0</td>
      <td>188367</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_E</td>
      <td>117105</td>
      <td>3422557</td>
      <td>NaN</td>
      <td>246751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
<p>We see a lot of NaN values in both our dataframes so far. While it could be assumed these values are 0 it is interesting to see some 0 values are already present in the dataframes. Assuming NaN is 0 is valid however, as it means in different compounds in the case of data2 there is no readings for these samples as they are not present.</p>
<p>We use a simple imputer based on the average value of columns to calculate NaN values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nan_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data1</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">data1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">nan_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>58
</pre></div>
</div>
</div>
</div>
<p>The vast majority of columns have some NaN values. We could try follow a linear regression approach to predict these NaN values but this could be a very time consuming and costly approach performing LR on each of the 58 columns with NaN values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imp</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
<span class="n">imp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">imp</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4.65374000e+05, 1.02771500e+06, 1.79894074e+04, ...,
        1.73037615e+05, 6.62122074e+05, 8.24690630e+07],
       [1.93151000e+05, 1.05097400e+06, 1.79894074e+04, ...,
        1.73037615e+05, 6.62122074e+05, 8.24690630e+07],
       [4.03286000e+05, 1.85039100e+06, 1.79894074e+04, ...,
        1.73037615e+05, 6.62122074e+05, 8.24690630e+07],
       ...,
       [3.09004000e+05, 5.65081300e+06, 0.00000000e+00, ...,
        0.00000000e+00, 0.00000000e+00, 7.21023920e+07],
       [5.48442000e+05, 3.58815800e+06, 0.00000000e+00, ...,
        0.00000000e+00, 0.00000000e+00, 8.52575460e+07],
       [3.39404000e+05, 3.96292700e+06, 0.00000000e+00, ...,
        0.00000000e+00, 4.82026000e+05, 9.71565490e+07]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputed_data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imp</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="n">heading_d1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">columns</span>
<span class="n">imputed_data1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">heading_d1</span>
<span class="n">imputed_data1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>Butanoic acid, 2-methyl-, methyl ester</th>
      <th>Isobutyl acetate</th>
      <th>Methyl isovalerate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>465374.0</td>
      <td>1027715.0</td>
      <td>17989.407407</td>
      <td>1289650.0</td>
      <td>800581.0</td>
      <td>324424.000000</td>
      <td>73015.0</td>
      <td>287247.703704</td>
      <td>46016.203704</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.098782e+06</td>
      <td>97878.333333</td>
      <td>85753.37037</td>
      <td>10167.740741</td>
      <td>94159.37037</td>
      <td>85581.62963</td>
      <td>586042.296296</td>
      <td>173037.615385</td>
      <td>662122.074074</td>
      <td>82469063.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>193151.0</td>
      <td>1050974.0</td>
      <td>17989.407407</td>
      <td>504113.0</td>
      <td>294680.0</td>
      <td>189630.000000</td>
      <td>0.0</td>
      <td>287247.703704</td>
      <td>46016.203704</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.098782e+06</td>
      <td>97878.333333</td>
      <td>85753.37037</td>
      <td>10167.740741</td>
      <td>94159.37037</td>
      <td>85581.62963</td>
      <td>586042.296296</td>
      <td>173037.615385</td>
      <td>662122.074074</td>
      <td>82469063.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>403286.0</td>
      <td>1850391.0</td>
      <td>17989.407407</td>
      <td>1169501.0</td>
      <td>15.0</td>
      <td>228163.000000</td>
      <td>73558.0</td>
      <td>287247.703704</td>
      <td>46016.203704</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.098782e+06</td>
      <td>97878.333333</td>
      <td>85753.37037</td>
      <td>10167.740741</td>
      <td>94159.37037</td>
      <td>85581.62963</td>
      <td>586042.296296</td>
      <td>173037.615385</td>
      <td>662122.074074</td>
      <td>82469063.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>129833.0</td>
      <td>5140770.0</td>
      <td>17989.407407</td>
      <td>1926072.0</td>
      <td>124282.0</td>
      <td>0.000000</td>
      <td>188367.0</td>
      <td>287247.703704</td>
      <td>46016.203704</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.098782e+06</td>
      <td>97878.333333</td>
      <td>85753.37037</td>
      <td>10167.740741</td>
      <td>94159.37037</td>
      <td>85581.62963</td>
      <td>586042.296296</td>
      <td>173037.615385</td>
      <td>662122.074074</td>
      <td>82469063.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>117105.0</td>
      <td>3422557.0</td>
      <td>17989.407407</td>
      <td>246751.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>287247.703704</td>
      <td>46016.203704</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.098782e+06</td>
      <td>97878.333333</td>
      <td>85753.37037</td>
      <td>10167.740741</td>
      <td>94159.37037</td>
      <td>85581.62963</td>
      <td>586042.296296</td>
      <td>173037.615385</td>
      <td>662122.074074</td>
      <td>82469063.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>79</th>
      <td>119313.0</td>
      <td>1364553.0</td>
      <td>0.000000</td>
      <td>169495.0</td>
      <td>0.0</td>
      <td>218195.561404</td>
      <td>0.0</td>
      <td>287247.703704</td>
      <td>0.000000</td>
      <td>97276.929825</td>
      <td>...</td>
      <td>2.896150e+05</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>60325589.0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>128397.0</td>
      <td>1451138.0</td>
      <td>0.000000</td>
      <td>359499.0</td>
      <td>0.0</td>
      <td>218195.561404</td>
      <td>0.0</td>
      <td>287247.703704</td>
      <td>0.000000</td>
      <td>97276.929825</td>
      <td>...</td>
      <td>7.499420e+05</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>78672.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>107880324.0</td>
    </tr>
    <tr>
      <th>81</th>
      <td>309004.0</td>
      <td>5650813.0</td>
      <td>0.000000</td>
      <td>875905.0</td>
      <td>0.0</td>
      <td>218195.561404</td>
      <td>109170.0</td>
      <td>287247.703704</td>
      <td>0.000000</td>
      <td>97276.929825</td>
      <td>...</td>
      <td>4.793150e+05</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>84426.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>72102392.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>548442.0</td>
      <td>3588158.0</td>
      <td>0.000000</td>
      <td>637563.0</td>
      <td>0.0</td>
      <td>218195.561404</td>
      <td>60834.0</td>
      <td>287247.703704</td>
      <td>0.000000</td>
      <td>97276.929825</td>
      <td>...</td>
      <td>2.750809e+06</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>146349.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>85257546.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>339404.0</td>
      <td>3962927.0</td>
      <td>0.000000</td>
      <td>2988409.0</td>
      <td>348154.0</td>
      <td>218195.561404</td>
      <td>694251.0</td>
      <td>287247.703704</td>
      <td>0.000000</td>
      <td>97276.929825</td>
      <td>...</td>
      <td>8.172616e+06</td>
      <td>698476.000000</td>
      <td>382222.00000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>635257.000000</td>
      <td>0.000000</td>
      <td>482026.000000</td>
      <td>97156549.0</td>
    </tr>
  </tbody>
</table>
<p>84 rows × 67 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Chemical_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alcohol                   24
Ketone                    12
Fatty acid ethyl ester    11
Ester                      6
Acid                       4
Aldehyde                   2
Pyrrole                    2
Alkane                     2
Alkene                     1
Lactone                    1
Nitrile                    1
Indole                     1
Name: Chemical_class, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_features1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">training_features1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Strain</th>
      <th>Samples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_C</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_D</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_E</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>EC</td>
      <td>EC_B</td>
      <td>EC.B_TSB_A</td>
    </tr>
    <tr>
      <th>83</th>
      <td>EC</td>
      <td>EC_B</td>
      <td>EC.B_TSB_B</td>
    </tr>
    <tr>
      <th>84</th>
      <td>EC</td>
      <td>EC_B</td>
      <td>EC.B_TSB_C</td>
    </tr>
    <tr>
      <th>85</th>
      <td>EC</td>
      <td>EC_B</td>
      <td>EC.B_TSB_D</td>
    </tr>
    <tr>
      <th>86</th>
      <td>EC</td>
      <td>EC_B</td>
      <td>EC.B_TSB_E</td>
    </tr>
  </tbody>
</table>
<p>84 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">training_features1</span><span class="o">.</span><span class="n">Species</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SA    0.357143
EC    0.321429
PA    0.321429
Name: Species, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">training_features1</span><span class="o">.</span><span class="n">Strain</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SA_A    0.178571
SA_B    0.178571
PA_A    0.166667
EC_A    0.166667
EC_B    0.154762
PA_B    0.154762
Name: Strain, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">training_features1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SA.A_TSB_D    0.011905
PA.A_LB_A     0.011905
EC.B_LB_C     0.011905
SA.B_BHI_A    0.011905
SA.B_TSB_D    0.011905
                ...   
PA.B_BHI_E    0.011905
SA.B_TSB_B    0.011905
SA.B_TSB_C    0.011905
PA.A_LB_E     0.011905
SA.A_TSB_A    0.011905
Name: Samples , Length: 84, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(84, 70)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SA&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">,</span>
                      <span class="n">index</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                      <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">])</span>
<span class="n">y_pred</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>SA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SA</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SA</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
<span class="n">numeric_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">numeric_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">category</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">imputed_data1</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">],</span> <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_1
The task is regression with evaluation metric rmse
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;, &#39;Random Forest&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 3 models
1_Baseline rmse 434163.499277 trained in 0.89 seconds
2_DecisionTree rmse 497813.325911 trained in 13.19 seconds
3_Linear rmse 355103.619375 trained in 8.07 seconds
* Step default_algorithms will try to check up to 2 models
4_Default_RandomForest rmse 378897.086861 trained in 2.98 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors rmse 482167.360408 trained in 0.99 seconds
* Step ensemble will try to check up to 1 model
Ensemble rmse 329538.037808 trained in 0.36 seconds
AutoML fit time: 35.46 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;,
                   &#39;Random Forest&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_predicted</span>
<span class="c1">#print(pd.DataFrame({&quot;Predicted&quot;: y_predicted[], &quot;Species&quot;: np.array(y_test)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([587990.58813961, 484754.94988278, 259113.26032363, 325029.07557432,
       330524.64935331, 490250.52366177, 495746.09744076, 336020.2231323 ,
       403759.57729218, 187703.77627443, 182208.20249544, 501241.67121975,
       593486.1619186 ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train25</span><span class="p">,</span> <span class="n">X_test25</span><span class="p">,</span> <span class="n">y_train25</span><span class="p">,</span> <span class="n">y_test25</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">imputed_data1</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl25</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">],</span> <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl25</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train25</span><span class="p">,</span> <span class="n">y_train25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_2
The task is regression with evaluation metric rmse
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;, &#39;Random Forest&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 3 models
1_Baseline rmse 246856.95428 trained in 0.53 seconds
2_DecisionTree rmse 247754.84449 trained in 4.07 seconds
3_Linear rmse 263535.381601 trained in 1.56 seconds
* Step default_algorithms will try to check up to 2 models
4_Default_RandomForest rmse 239064.915964 trained in 2.55 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors rmse 264147.803008 trained in 1.1 seconds
* Step ensemble will try to check up to 1 model
Ensemble rmse 238931.388536 trained in 0.41 seconds
AutoML fit time: 19.13 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;,
                   &#39;Random Forest&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="section" id="knn-impute-experiments">
<h1>KNN Impute Experiments<a class="headerlink" href="#knn-impute-experiments" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  465374. ,  1027715. ,        0. , ...,        0. ,        0. ,
        84102956.5],
       [  193151. ,  1050974. ,        0. , ...,   694807.5,   738730. ,
        92931159.5],
       [  403286. ,  1850391. ,        0. , ...,        0. ,        0. ,
        84102956.5],
       ...,
       [  309004. ,  5650813. ,        0. , ...,        0. ,        0. ,
        72102392. ],
       [  548442. ,  3588158. ,        0. , ...,        0. ,        0. ,
        85257546. ],
       [  339404. ,  3962927. ,        0. , ...,        0. ,   482026. ,
        97156549. ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="n">heading_d1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">columns</span>
<span class="n">knn_imputed</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">heading_d1</span>
<span class="n">knn_imputed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>Butanoic acid, 2-methyl-, methyl ester</th>
      <th>Isobutyl acetate</th>
      <th>Methyl isovalerate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>465374.0</td>
      <td>1027715.0</td>
      <td>0.0</td>
      <td>1289650.0</td>
      <td>800581.0</td>
      <td>324424.0</td>
      <td>73015.0</td>
      <td>1045093.0</td>
      <td>74647.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>519778.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>39336.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>84102956.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>193151.0</td>
      <td>1050974.0</td>
      <td>0.0</td>
      <td>504113.0</td>
      <td>294680.0</td>
      <td>189630.0</td>
      <td>0.0</td>
      <td>1268001.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>711040.5</td>
      <td>0.0</td>
      <td>45529.0</td>
      <td>0.0</td>
      <td>142667.5</td>
      <td>70604.5</td>
      <td>263691.5</td>
      <td>694807.5</td>
      <td>738730.0</td>
      <td>92931159.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>403286.0</td>
      <td>1850391.0</td>
      <td>0.0</td>
      <td>1169501.0</td>
      <td>15.0</td>
      <td>228163.0</td>
      <td>73558.0</td>
      <td>1064532.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>519778.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>39336.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>84102956.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>129833.0</td>
      <td>5140770.0</td>
      <td>0.0</td>
      <td>1926072.0</td>
      <td>124282.0</td>
      <td>0.0</td>
      <td>188367.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>4325965.5</td>
      <td>349238.0</td>
      <td>191111.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>359841.5</td>
      <td>0.0</td>
      <td>241013.0</td>
      <td>84629470.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>117105.0</td>
      <td>3422557.0</td>
      <td>0.0</td>
      <td>246751.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1268001.5</td>
      <td>74647.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>5461712.5</td>
      <td>349238.0</td>
      <td>191111.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>390803.0</td>
      <td>0.0</td>
      <td>241013.0</td>
      <td>91207047.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>79</th>
      <td>119313.0</td>
      <td>1364553.0</td>
      <td>0.0</td>
      <td>169495.0</td>
      <td>0.0</td>
      <td>159997.0</td>
      <td>0.0</td>
      <td>549406.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>289615.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>60325589.0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>128397.0</td>
      <td>1451138.0</td>
      <td>0.0</td>
      <td>359499.0</td>
      <td>0.0</td>
      <td>159997.0</td>
      <td>0.0</td>
      <td>1268001.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>749942.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>78672.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>107880324.0</td>
    </tr>
    <tr>
      <th>81</th>
      <td>309004.0</td>
      <td>5650813.0</td>
      <td>0.0</td>
      <td>875905.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>109170.0</td>
      <td>670738.0</td>
      <td>0.0</td>
      <td>165645.5</td>
      <td>...</td>
      <td>479315.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>84426.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>72102392.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>548442.0</td>
      <td>3588158.0</td>
      <td>0.0</td>
      <td>637563.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>60834.0</td>
      <td>718595.0</td>
      <td>0.0</td>
      <td>130092.0</td>
      <td>...</td>
      <td>2750809.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146349.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>85257546.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>339404.0</td>
      <td>3962927.0</td>
      <td>0.0</td>
      <td>2988409.0</td>
      <td>348154.0</td>
      <td>0.0</td>
      <td>694251.0</td>
      <td>705833.0</td>
      <td>0.0</td>
      <td>132044.0</td>
      <td>...</td>
      <td>8172616.0</td>
      <td>698476.0</td>
      <td>382222.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>635257.0</td>
      <td>0.0</td>
      <td>482026.0</td>
      <td>97156549.0</td>
    </tr>
  </tbody>
</table>
<p>84 rows × 67 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainknn</span><span class="p">,</span> <span class="n">X_testknn</span><span class="p">,</span> <span class="n">y_trainknn</span><span class="p">,</span> <span class="n">y_testknn</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">knn_imputed</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">],</span> <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainknn</span><span class="p">,</span> <span class="n">y_trainknn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_3
The task is regression with evaluation metric rmse
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;, &#39;Random Forest&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 3 models
1_Baseline rmse 229605.700218 trained in 0.58 seconds
2_DecisionTree rmse 491324.331872 trained in 4.05 seconds
3_Linear rmse 778164.69303 trained in 2.22 seconds
* Step default_algorithms will try to check up to 2 models
4_Default_RandomForest rmse 175504.124782 trained in 2.26 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors rmse 188088.298472 trained in 1.22 seconds
* Step ensemble will try to check up to 1 model
Ensemble rmse 173853.803084 trained in 0.33 seconds
AutoML fit time: 20.02 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;,
                   &#39;Random Forest&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainknn25</span><span class="p">,</span> <span class="n">X_testknn25</span><span class="p">,</span> <span class="n">y_trainknn25</span><span class="p">,</span> <span class="n">y_testknn25</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">knn_imputed</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Baseline&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">],</span> <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainknn25</span><span class="p">,</span> <span class="n">y_trainknn25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_4
The task is regression with evaluation metric rmse
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;, &#39;Random Forest&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 3 models
1_Baseline rmse 253097.581351 trained in 0.6 seconds
2_DecisionTree rmse 255857.381857 trained in 4.12 seconds
3_Linear rmse 264675.491844 trained in 1.59 seconds
* Step default_algorithms will try to check up to 2 models
4_Default_RandomForest rmse 242098.464173 trained in 2.78 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
X does not have valid feature names, but KNeighborsRegressor was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors rmse 278028.785964 trained in 0.86 seconds
* Step ensemble will try to check up to 1 model
Ensemble rmse 242098.464173 trained in 0.38 seconds
AutoML fit time: 19.37 seconds
AutoML best model: 4_Default_RandomForest
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Nearest Neighbors&#39;, &#39;Baseline&#39;,
                   &#39;Random Forest&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Strain</th>
      <th>Samples</th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_A</td>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_B</td>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_C</td>
      <td>403286</td>
      <td>1850391</td>
      <td>NaN</td>
      <td>1169501</td>
      <td>15</td>
      <td>228163</td>
      <td>73558</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_D</td>
      <td>129833</td>
      <td>5140770</td>
      <td>NaN</td>
      <td>1926072</td>
      <td>124282</td>
      <td>0</td>
      <td>188367</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SA</td>
      <td>SA_A</td>
      <td>SA.A_TSB_E</td>
      <td>117105</td>
      <td>3422557</td>
      <td>NaN</td>
      <td>246751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="actual-tests-nan-present">
<h1>Actual Tests NaN present<a class="headerlink" href="#actual-tests-nan-present" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:])</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>Butanoic acid, 2-methyl-, methyl ester</th>
      <th>Isobutyl acetate</th>
      <th>Methyl isovalerate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>403286</td>
      <td>1850391</td>
      <td>NaN</td>
      <td>1169501</td>
      <td>15</td>
      <td>228163</td>
      <td>73558</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>129833</td>
      <td>5140770</td>
      <td>NaN</td>
      <td>1926072</td>
      <td>124282</td>
      <td>0</td>
      <td>188367</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>117105</td>
      <td>3422557</td>
      <td>NaN</td>
      <td>246751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 67 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:23:19,811 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;PA_B&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_5
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 3.225204 trained in 21.14 seconds
2_Linear logloss 1.357509 trained in 26.54 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 1.54975 trained in 36.43 seconds
4_Default_RandomForest logloss 0.912605 trained in 21.82 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 3.425839 trained in 5.16 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.90312 trained in 0.38 seconds
AutoML fit time: 129.97 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_predicted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Predicted Target
0      EC_B   EC_B
1      SA_B   SA_A
2      SA_B   SA_B
3      EC_B   EC_B
4      SA_A   SA_A
5      PA_B   PA_B
6      SA_A   SA_A
7      SA_A   SA_A
8      EC_B   PA_A
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valuesy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">accuracy_auto</span><span class="p">(</span><span class="n">array_pred</span><span class="p">,</span> <span class="n">array_target</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">zx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array_target</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_pred</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">array_pred</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">zx</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span><span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted</span><span class="p">,</span> <span class="n">valuesy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7777777777777778
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train30</span><span class="p">,</span> <span class="n">X_test30</span><span class="p">,</span> <span class="n">y_train30</span><span class="p">,</span> <span class="n">y_test30</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train30</span><span class="p">,</span> <span class="n">y_train30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:25:30,178 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;PA_B&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_6
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 5.586492 trained in 21.51 seconds
2_Linear logloss 1.5819 trained in 20.18 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 1.684719 trained in 21.95 seconds
4_Default_RandomForest logloss 1.169727 trained in 23.02 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 3.871066 trained in 5.31 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.985326 trained in 0.51 seconds
AutoML fit time: 109.16 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted30</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test30</span><span class="p">)</span>
<span class="n">y_predicted30</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted30</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted30</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test30</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Predicted Target
0       EC_B   EC_B
1       SA_A   SA_A
2       SA_B   SA_B
3       EC_B   EC_B
4       SA_A   SA_A
5       PA_A   PA_B
6       SA_A   SA_A
7       SA_A   SA_A
8       PA_A   PA_A
9       PA_B   PA_B
10      PA_A   PA_A
11      SA_A   SA_A
12      SA_A   SA_B
13      PA_A   SA_A
14      EC_A   EC_A
15      EC_B   EC_B
16      PA_B   PA_B
17      PA_A   PA_A
18      SA_A   SA_A
19      PA_B   PA_B
20      EC_A   EC_A
21      SA_A   SA_B
22      EC_B   EC_A
23      SA_A   SA_B
24      EC_B   EC_A
25      PA_A   PA_A
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted30</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7307692307692307
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train20</span><span class="p">,</span> <span class="n">X_test20</span><span class="p">,</span> <span class="n">y_train20</span><span class="p">,</span> <span class="n">y_test20</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train20</span><span class="p">,</span> <span class="n">y_train20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:27:19,831 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;PA_A&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_7
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 7.387692 trained in 24.8 seconds
2_Linear logloss 0.763105 trained in 27.39 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 1.623978 trained in 28.75 seconds
4_Default_RandomForest logloss 1.139257 trained in 26.32 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 2.81669 trained in 7.39 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.763105 trained in 0.38 seconds
AutoML fit time: 136.17 seconds
AutoML best model: 2_Linear
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted20</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test20</span><span class="p">)</span>
<span class="n">y_predicted20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted20</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted20</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test20</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Predicted Target
0       EC_B   EC_B
1       SA_A   SA_A
2       SA_A   SA_B
3       EC_B   EC_B
4       SA_A   SA_A
5       PA_A   PA_B
6       SA_A   SA_A
7       SA_A   SA_A
8       PA_A   PA_A
9       PA_A   PA_B
10      PA_A   PA_A
11      SA_A   SA_A
12      SA_A   SA_B
13      SA_A   SA_A
14      EC_B   EC_A
15      EC_B   EC_B
16      PA_A   PA_B
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted20</span><span class="p">,</span> <span class="n">y_test20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6470588235294118
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ethyl Acetate</th>
      <th>Ethanol</th>
      <th>Propanoic acid, ethyl ester</th>
      <th>2-Pentanone</th>
      <th>Decane</th>
      <th>Methyl Isobutyl Ketone</th>
      <th>Amylene hydrate</th>
      <th>Butanoic acid, 2-methyl-, methyl ester</th>
      <th>Isobutyl acetate</th>
      <th>Methyl isovalerate</th>
      <th>...</th>
      <th>1-Dodecanol</th>
      <th>Methyl tetradecanoate</th>
      <th>2-Pentadecanone</th>
      <th>Tetradecanoic acid, ethyl ester</th>
      <th>Hexadecanal</th>
      <th>n-Tridecan-1-ol</th>
      <th>1-Tetradecanol</th>
      <th>n-Pentadecanol</th>
      <th>1-Hexadecanol</th>
      <th>Indole</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>465374</td>
      <td>1027715</td>
      <td>NaN</td>
      <td>1289650</td>
      <td>800581</td>
      <td>324424</td>
      <td>73015</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>193151</td>
      <td>1050974</td>
      <td>NaN</td>
      <td>504113</td>
      <td>294680</td>
      <td>189630</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>403286</td>
      <td>1850391</td>
      <td>NaN</td>
      <td>1169501</td>
      <td>15</td>
      <td>228163</td>
      <td>73558</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>129833</td>
      <td>5140770</td>
      <td>NaN</td>
      <td>1926072</td>
      <td>124282</td>
      <td>0</td>
      <td>188367</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>117105</td>
      <td>3422557</td>
      <td>NaN</td>
      <td>246751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 67 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train25</span><span class="p">,</span> <span class="n">X_test25</span><span class="p">,</span> <span class="n">y_train25</span><span class="p">,</span> <span class="n">y_test25</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train25</span><span class="p">,</span> <span class="n">y_train25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:29:36,518 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;SA_B&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_8
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 2.412218 trained in 27.16 seconds
2_Linear logloss 0.666864 trained in 25.64 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 1.336914 trained in 28.71 seconds
4_Default_RandomForest logloss 1.00787 trained in 22.72 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 1.617412 trained in 5.19 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.666864 trained in 0.53 seconds
AutoML fit time: 127.3 seconds
AutoML best model: 2_Linear
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted25</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test25</span><span class="p">)</span>
<span class="n">y_predicted25</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted25</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted25</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test25</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Predicted Target
0       EC_B   EC_B
1       SA_A   SA_A
2       SA_A   SA_B
3       EC_B   EC_B
4       SA_A   SA_A
5       PA_A   PA_B
6       SA_A   SA_A
7       SA_A   SA_A
8       PA_A   PA_A
9       PA_B   PA_B
10      PA_A   PA_A
11      SA_A   SA_A
12      SA_A   SA_B
13      PA_A   SA_A
14      PA_A   EC_A
15      EC_B   EC_B
16      PA_A   PA_B
17      PA_A   PA_A
18      SA_A   SA_A
19      PA_A   PA_B
20      EC_B   EC_A
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted25</span><span class="p">,</span> <span class="n">y_test25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6190476190476191
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train40</span><span class="p">,</span> <span class="n">X_test40</span><span class="p">,</span> <span class="n">y_train40</span><span class="p">,</span> <span class="n">y_test40</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train40</span><span class="p">,</span> <span class="n">y_train40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:31:44,094 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;PA_A&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_9
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 1.854583 trained in 20.65 seconds
2_Linear logloss 0.377057 trained in 21.18 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 0.916796 trained in 22.03 seconds
4_Default_RandomForest logloss 0.76903 trained in 21.66 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 0.47707 trained in 5.23 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.377057 trained in 0.34 seconds
AutoML fit time: 107.72 seconds
AutoML best model: 2_Linear
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted40</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test40</span><span class="p">)</span>
<span class="n">y_predicted40</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted40</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted40</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test40</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Predicted Target
0       EC_B   EC_B
1       SA_A   SA_A
2       SA_B   SA_B
3       EC_B   EC_B
4       SA_A   SA_A
5       PA_A   PA_B
6       SA_A   SA_A
7       SA_B   SA_A
8       PA_A   PA_A
9       PA_B   PA_B
10      PA_A   PA_A
11      SA_B   SA_A
12      SA_A   SA_B
13      SA_B   SA_A
14      EC_A   EC_A
15      EC_B   EC_B
16      PA_B   PA_B
17      PA_B   PA_A
18      SA_A   SA_A
19      PA_B   PA_B
20      EC_A   EC_A
21      SA_B   SA_B
22      EC_B   EC_A
23      EC_B   SA_B
24      EC_B   EC_A
25      PA_A   PA_A
26      PA_B   PA_B
27      PA_B   PA_B
28      SA_B   SA_A
29      SA_B   SA_B
30      PA_B   PA_A
31      SA_A   SA_B
32      PA_A   PA_A
33      EC_A   EC_A
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted40</span><span class="p">,</span> <span class="n">y_test40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6470588235294118
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train50</span><span class="p">,</span> <span class="n">X_test50</span><span class="p">,</span> <span class="n">y_train50</span><span class="p">,</span> <span class="n">y_test50</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">AutoML</span><span class="p">(</span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;Nearest Neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;Xgboost&quot;</span><span class="p">],</span>
                <span class="n">total_time_limit</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train50</span><span class="p">,</span> <span class="n">y_train50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-20 21:33:32,121 supervised.preprocessing.eda ERROR There was an issue when running EDA. could not convert string to float: &#39;EC_A&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML directory: AutoML_10
The task is multiclass_classification with evaluation metric logloss
AutoML will use algorithms: [&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;, &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;]
AutoML will ensemble available models
AutoML steps: [&#39;simple_algorithms&#39;, &#39;default_algorithms&#39;, &#39;ensemble&#39;]
* Step simple_algorithms will try to check up to 2 models
1_DecisionTree logloss 11.51293 trained in 21.87 seconds
2_Linear logloss 0.456629 trained in 21.83 seconds
* Step default_algorithms will try to check up to 3 models
3_Default_Xgboost logloss 1.421264 trained in 22.53 seconds
4_Default_RandomForest logloss 1.63988 trained in 47.12 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception while producing SHAP explanations. &#39;NoneType&#39; object has no attribute &#39;shap_values&#39;
Continuing ...
5_Default_NearestNeighbors logloss 0.788799 trained in 7.75 seconds
* Step ensemble will try to check up to 1 model
Ensemble logloss 0.398333 trained in 0.55 seconds
AutoML fit time: 142.81 seconds
AutoML best model: Ensemble
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML(algorithms=[&#39;Decision Tree&#39;, &#39;Linear&#39;, &#39;Random Forest&#39;,
                   &#39;Nearest Neighbors&#39;, &#39;Xgboost&#39;],
       total_time_limit=300)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predicted50</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test50</span><span class="p">)</span>
<span class="n">y_predicted50</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_predicted50</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Strain&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">y_predicted50</span><span class="p">[</span><span class="s2">&quot;Strain&quot;</span><span class="p">],</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test50</span><span class="p">)}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Predicted Target
0       EC_B   EC_B
1       SA_A   SA_A
2       SA_B   SA_B
3       EC_B   EC_B
4       SA_A   SA_A
5       PA_A   PA_B
6       SA_A   SA_A
7       SA_B   SA_A
8       PA_A   PA_A
9       PA_B   PA_B
10      PA_B   PA_A
11      SA_B   SA_A
12      SA_A   SA_B
13      SA_B   SA_A
14      EC_A   EC_A
15      EC_B   EC_B
16      PA_B   PA_B
17      PA_B   PA_A
18      SA_A   SA_A
19      PA_B   PA_B
20      EC_A   EC_A
21      SA_B   SA_B
22      EC_A   EC_A
23      SA_A   SA_B
24      EC_B   EC_A
25      PA_B   PA_A
26      PA_B   PA_B
27      PA_B   PA_B
28      SA_B   SA_A
29      SA_B   SA_B
30      PA_B   PA_A
31      SA_A   SA_B
32      PA_B   PA_A
33      EC_A   EC_A
34      PA_A   PA_A
35      PA_A   PA_B
36      EC_B   EC_B
37      SA_A   SA_A
38      SA_A   SA_A
39      EC_B   EC_A
40      EC_B   EC_B
41      EC_A   EC_A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_auto</span><span class="p">(</span><span class="n">y_predicted50</span><span class="p">,</span> <span class="n">y_test50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6190476190476191
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">KFold</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<span class="c1"># Number of random trials</span>
<span class="n">NUM_TRIALS</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># Load the dataset</span>
<span class="n">X_iris</span> <span class="o">=</span> <span class="n">imputed_data1</span>
<span class="n">y_iris</span> <span class="o">=</span> <span class="n">y1</span>

<span class="c1"># Set up possible values of parameters to optimize over</span>
<span class="n">p_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
          <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.1</span><span class="p">]}</span>

<span class="c1"># We will use a Support Vector Classifier with &quot;rbf&quot; kernel</span>
<span class="n">svm</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span>

<span class="c1"># Arrays to store scores</span>
<span class="n">non_nested_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM_TRIALS</span><span class="p">)</span>
<span class="n">nested_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM_TRIALS</span><span class="p">)</span>

<span class="c1"># Loop for each trial</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_TRIALS</span><span class="p">):</span>

    <span class="c1"># Choose cross-validation techniques for the inner and outer loops,</span>
    <span class="c1"># independently of the dataset.</span>
    <span class="c1"># E.g &quot;GroupKFold&quot;, &quot;LeaveOneOut&quot;, &quot;LeaveOneGroupOut&quot;, etc.</span>
    <span class="n">inner_cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">outer_cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Non_nested parameter search and scoring</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">outer_cv</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span><span class="p">)</span>
    <span class="n">non_nested_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_score_</span>

    <span class="c1"># Nested CV with parameter optimization</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">inner_cv</span><span class="p">)</span>
    <span class="n">nested_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X_iris</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_iris</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">outer_cv</span><span class="p">)</span>
    <span class="n">nested_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nested_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">score_difference</span> <span class="o">=</span> <span class="n">non_nested_scores</span> <span class="o">-</span> <span class="n">nested_scores</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average difference of </span><span class="si">{:6f}</span><span class="s2"> with std. dev. of </span><span class="si">{:6f}</span><span class="s2">.&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score_difference</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">score_difference</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>

<span class="c1"># Plot scores on each trial for nested and non-nested CV</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">non_nested_scores_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">non_nested_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">nested_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nested_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;14&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">non_nested_scores_line</span><span class="p">,</span> <span class="n">nested_line</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">&quot;Non-Nested CV&quot;</span><span class="p">,</span> <span class="s2">&quot;Nested CV&quot;</span><span class="p">],</span>
           <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Non-Nested and Nested Cross Validation on Imputed Dataset&quot;</span><span class="p">,</span>
          <span class="n">x</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="p">)</span>

<span class="c1"># Plot bar chart of the difference.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">difference_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">NUM_TRIALS</span><span class="p">),</span> <span class="n">score_difference</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Individual Trial #&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">difference_plot</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">&quot;Non-Nested CV - Nested CV Score&quot;</span><span class="p">],</span>
           <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;score difference&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;14&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Automatically created module for IPython interactive environment
Average difference of 0.000000 with std. dev. of 0.000000.
</pre></div>
</div>
<img alt="_images/data-processing_78_1.png" src="_images/data-processing_78_1.png" />
</div>
</div>
</div>
<div class="section" id="random-forest-classifier">
<h1>Random Forest Classifier<a class="headerlink" href="#random-forest-classifier" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rf-for-strain-at-20-split">
<h2>RF for Strain at 20% Split<a class="headerlink" href="#rf-for-strain-at-20-split" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="n">array_pred</span><span class="p">,</span> <span class="n">array_target</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">zx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array_target</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_pred</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">array_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">zx</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span><span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from sklearn.impute import SimpleImputer</span>
<span class="c1">#imp = SimpleImputer(missing_values=np.nan, strategy=&#39;mean&#39;)</span>
<span class="c1">#num = data1.iloc[:, 3:]</span>
<span class="c1">#imp.fit(num)</span>
<span class="c1">#imp.transform(num)</span>
<span class="c1">#imputed_data1 = pd.DataFrame(imp.transform(num))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xyz</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span>
<span class="n">xyz</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3     SA_A
4     SA_A
5     SA_A
6     SA_A
7     SA_A
      ... 
82    EC_B
83    EC_B
84    EC_B
85    EC_B
86    EC_B
Name: Strain, Length: 84, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exit_status_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SA_A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SA_B&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">,</span><span class="s1">&#39;EC_A&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;PA_A&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;EC_B&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;PA_B&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">exit_status_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf</span><span class="p">,</span> <span class="n">X_testrf</span><span class="p">,</span> <span class="n">y_trainrf</span><span class="p">,</span> <span class="n">y_testrf</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf</span><span class="p">,</span> <span class="n">y_trainrf</span><span class="p">)</span>
<span class="n">y_predrf</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf</span> <span class="o">=</span> <span class="n">y_predrf</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 4 2 3 0 4 0 4 1 0 3 0 2 2 0 0 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          4       3
46          2       3
53          3       3
25          0       0
57          4       5
5           0       0
59          4       5
29          1       1
11          0       1
72          3       4
16          0       0
69          2       2
80          2       2
19          0       1
30          0       1
78          2       2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_predrf</span><span class="p">,</span> <span class="n">y_testrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5294117647058824
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 20:80 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf20</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf</span><span class="p">,</span> <span class="n">y_trainrf</span><span class="p">)</span>
<span class="n">clf20</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf</span><span class="p">,</span> <span class="n">y_testrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7058823529411765
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf</span><span class="p">,</span> <span class="n">y_testrf</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.64 accuracy with a standard deviation of 0.14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The least populated class in y has only 1 members, which is less than n_splits=4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf</span><span class="p">,</span><span class="n">y_predrf</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf</span><span class="p">,</span><span class="n">y_predrf</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[3 0 0 0 0 0]
 [3 1 0 0 0 0]
 [0 0 3 0 0 0]
 [0 0 1 2 1 0]
 [0 0 0 1 0 0]
 [0 0 0 0 2 0]]
              precision    recall  f1-score   support

           0       0.50      1.00      0.67         3
           1       1.00      0.25      0.40         4
           2       0.75      1.00      0.86         3
           3       0.67      0.50      0.57         4
           4       0.00      0.00      0.00         1
           5       0.00      0.00      0.00         2

    accuracy                           0.53        17
   macro avg       0.49      0.46      0.42        17
weighted avg       0.61      0.53      0.50        17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="split">
<h2>10% Split<a class="headerlink" href="#split" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf10</span><span class="p">,</span> <span class="n">X_testrf10</span><span class="p">,</span> <span class="n">y_trainrf10</span><span class="p">,</span> <span class="n">y_testrf10</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf10</span><span class="p">,</span> <span class="n">y_trainrf10</span><span class="p">)</span>
<span class="n">y_predrf10</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf10</span> <span class="o">=</span> <span class="n">y_predrf10</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 4 3 3 0 4 0 4 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf10</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf10</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          4       3
46          3       3
53          3       3
25          0       0
57          4       5
5           0       0
59          4       5
29          1       1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_predrf10</span><span class="p">,</span> <span class="n">y_testrf10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6666666666666666
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 10:90 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf10</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf10</span><span class="p">,</span> <span class="n">y_trainrf10</span><span class="p">)</span>
<span class="n">clf10</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf10</span><span class="p">,</span> <span class="n">y_testrf10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6666666666666666
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf10</span><span class="p">,</span> <span class="n">y_testrf10</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.54 accuracy with a standard deviation of 0.36
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The least populated class in y has only 1 members, which is less than n_splits=4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf10</span><span class="p">,</span><span class="n">y_predrf10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf10</span><span class="p">,</span><span class="n">y_predrf10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 0 0 0 0]
 [0 1 0 0 0]
 [0 0 3 1 0]
 [0 0 0 0 0]
 [0 0 0 2 0]]
              precision    recall  f1-score   support

           0       1.00      1.00      1.00         2
           1       1.00      1.00      1.00         1
           3       1.00      0.75      0.86         4
           4       0.00      0.00      0.00         0
           5       0.00      0.00      0.00         2

    accuracy                           0.67         9
   macro avg       0.60      0.55      0.57         9
weighted avg       0.78      0.67      0.71         9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>40%<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf40</span><span class="p">,</span> <span class="n">X_testrf40</span><span class="p">,</span> <span class="n">y_trainrf40</span><span class="p">,</span> <span class="n">y_testrf40</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf40</span><span class="p">,</span> <span class="n">y_trainrf40</span><span class="p">)</span>
<span class="n">y_predrf40</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf40</span> <span class="o">=</span> <span class="n">y_predrf40</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 3 2 3 0 3 0 3 1 0 3 0 2 3 0 1 2 3 4 2 3 3 2 2 3 4 3 0 0 2 2 0 3 3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf40</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf40</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          3       3
46          2       3
53          3       3
25          0       0
57          3       5
5           0       0
59          3       5
29          1       1
11          0       1
72          3       4
16          0       0
69          2       2
80          3       2
19          0       1
30          1       1
78          2       2
76          3       4
51          4       5
77          2       2
86          3       4
64          3       4
44          2       3
66          2       4
58          3       5
48          4       5
75          3       4
9           0       1
6           0       0
71          2       2
62          2       2
10          0       1
36          3       3
55          3       3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_predrf40</span><span class="p">,</span> <span class="n">y_testrf40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.47058823529411764
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 20:80 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf40</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf40</span><span class="p">,</span> <span class="n">y_trainrf40</span><span class="p">)</span>
<span class="n">clf40</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf40</span><span class="p">,</span> <span class="n">y_testrf40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7647058823529411
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf40</span><span class="p">,</span> <span class="n">y_testrf40</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.61 accuracy with a standard deviation of 0.15
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf40</span><span class="p">,</span><span class="n">y_predrf40</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf40</span><span class="p">,</span><span class="n">y_predrf40</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[4 0 0 0 0 0]
 [4 2 0 0 0 0]
 [0 0 5 1 0 0]
 [0 0 2 5 0 0]
 [0 0 1 5 0 0]
 [0 0 0 3 2 0]]
              precision    recall  f1-score   support

           0       0.50      1.00      0.67         4
           1       1.00      0.33      0.50         6
           2       0.62      0.83      0.71         6
           3       0.36      0.71      0.48         7
           4       0.00      0.00      0.00         6
           5       0.00      0.00      0.00         5

    accuracy                           0.47        34
   macro avg       0.41      0.48      0.39        34
weighted avg       0.42      0.47      0.39        34
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>50% Split<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf50</span><span class="p">,</span> <span class="n">X_testrf50</span><span class="p">,</span> <span class="n">y_trainrf50</span><span class="p">,</span> <span class="n">y_testrf50</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf50</span><span class="p">,</span> <span class="n">y_trainrf50</span><span class="p">)</span>
<span class="n">y_predrf50</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf50</span> <span class="o">=</span> <span class="n">y_predrf50</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 4 3 3 0 3 0 4 0 1 3 0 2 2 1 0 2 3 4 2 3 3 2 3 3 4 3 0 1 2 3 0 3 3 3 0 1
 0 4 0 2 4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf50</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf50</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          4       3
46          3       3
53          3       3
25          0       0
57          3       5
5           0       0
59          4       5
29          0       1
11          1       1
72          3       4
16          0       0
69          2       2
80          2       2
19          1       1
30          0       1
78          2       2
76          3       4
51          4       5
77          2       2
86          3       4
64          3       4
44          2       3
66          3       4
58          3       5
48          4       5
75          3       4
9           0       1
6           1       0
71          2       2
62          3       2
10          0       1
36          3       3
55          3       3
63          3       2
7           0       0
18          1       1
20          0       1
41          4       5
8           0       1
79          2       2
45          4       3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_predrf50</span><span class="p">,</span> <span class="n">y_testrf50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.42857142857142855
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 50:50 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf50</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf50</span><span class="p">,</span> <span class="n">y_trainrf50</span><span class="p">)</span>
<span class="n">clf50</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf50</span><span class="p">,</span> <span class="n">y_testrf50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6190476190476191
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf50</span><span class="p">,</span> <span class="n">y_testrf50</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.74 accuracy with a standard deviation of 0.07
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf50</span><span class="p">,</span><span class="n">y_predrf50</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf50</span><span class="p">,</span><span class="n">y_predrf50</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[4 1 0 0 0 0]
 [6 3 0 0 0 0]
 [0 0 6 2 0 0]
 [0 0 1 5 2 0]
 [0 0 0 6 0 0]
 [0 0 0 2 4 0]]
              precision    recall  f1-score   support

           0       0.40      0.80      0.53         5
           1       0.75      0.33      0.46         9
           2       0.86      0.75      0.80         8
           3       0.33      0.62      0.43         8
           4       0.00      0.00      0.00         6
           5       0.00      0.00      0.00         6

    accuracy                           0.43        42
   macro avg       0.39      0.42      0.37        42
weighted avg       0.44      0.43      0.40        42
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>25% Split<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf25</span><span class="p">,</span> <span class="n">X_testrf25</span><span class="p">,</span> <span class="n">y_trainrf25</span><span class="p">,</span> <span class="n">y_testrf25</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf25</span><span class="p">,</span> <span class="n">y_trainrf25</span><span class="p">)</span>
<span class="n">y_predrf25</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf25</span> <span class="o">=</span> <span class="n">y_predrf25</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 4 3 3 0 4 0 4 1 0 3 0 2 2 0 0 2 3 4 2 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf25</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf25</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          4       3
46          3       3
53          3       3
25          0       0
57          4       5
5           0       0
59          4       5
29          1       1
11          0       1
72          3       4
16          0       0
69          2       2
80          2       2
19          0       1
30          0       1
78          2       2
76          3       4
51          4       5
77          2       2
86          2       4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf25</span><span class="p">),</span> <span class="n">y_testrf25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5238095238095238
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 25:75 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf25</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf25</span><span class="p">,</span> <span class="n">y_trainrf25</span><span class="p">)</span>
<span class="n">clf25</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf25</span><span class="p">,</span> <span class="n">y_testrf25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6666666666666666
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf25</span><span class="p">,</span> <span class="n">y_testrf25</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.62 accuracy with a standard deviation of 0.14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The least populated class in y has only 3 members, which is less than n_splits=4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf25</span><span class="p">,</span><span class="n">y_predrf25</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf25</span><span class="p">,</span><span class="n">y_predrf25</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[3 0 0 0 0 0]
 [3 1 0 0 0 0]
 [0 0 4 0 0 0]
 [0 0 0 3 1 0]
 [0 0 1 2 0 0]
 [0 0 0 0 3 0]]
              precision    recall  f1-score   support

           0       0.50      1.00      0.67         3
           1       1.00      0.25      0.40         4
           2       0.80      1.00      0.89         4
           3       0.60      0.75      0.67         4
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         3

    accuracy                           0.52        21
   macro avg       0.48      0.50      0.44        21
weighted avg       0.53      0.52      0.47        21
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>30% Split<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trainrf30</span><span class="p">,</span> <span class="n">X_testrf30</span><span class="p">,</span> <span class="n">y_trainrf30</span><span class="p">,</span> <span class="n">y_testrf30</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">imputed_data1</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf30</span><span class="p">,</span> <span class="n">y_trainrf30</span><span class="p">)</span>
<span class="n">y_predrf30</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testrf30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predrf30</span> <span class="o">=</span> <span class="n">y_predrf30</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predrf30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 4 2 3 0 4 0 4 0 0 3 0 2 2 0 0 2 2 4 2 3 3 2 2 4 4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Predicted&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf30</span><span class="p">),</span> <span class="s2">&quot;Target&quot;</span><span class="p">:</span> <span class="n">y_testrf30</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Predicted  Target
33          3       3
43          4       3
46          2       3
53          3       3
25          0       0
57          4       5
5           0       0
59          4       5
29          0       1
11          0       1
72          3       4
16          0       0
69          2       2
80          2       2
19          0       1
30          0       1
78          2       2
76          2       4
51          4       5
77          2       2
86          3       4
64          3       4
44          2       3
66          2       4
58          4       5
48          4       5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_predrf30</span><span class="p">),</span> <span class="n">y_testrf30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.34615384615384615
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cross-Validation for 30:70 RF split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="n">clf30</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainrf30</span><span class="p">,</span> <span class="n">y_trainrf30</span><span class="p">)</span>
<span class="n">clf30</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testrf30</span><span class="p">,</span> <span class="n">y_testrf30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6923076923076923
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_testrf30</span><span class="p">,</span> <span class="n">y_testrf30</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> accuracy with a standard deviation of </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.65 accuracy with a standard deviation of 0.05
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The least populated class in y has only 3 members, which is less than n_splits=4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_testrf30</span><span class="p">,</span><span class="n">y_predrf30</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_testrf30</span><span class="p">,</span><span class="n">y_predrf30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[3 0 0 0 0 0]
 [4 0 0 0 0 0]
 [0 0 4 0 0 0]
 [0 0 2 2 1 0]
 [0 0 2 3 0 0]
 [0 0 0 0 5 0]]
              precision    recall  f1-score   support

           0       0.43      1.00      0.60         3
           1       0.00      0.00      0.00         4
           2       0.50      1.00      0.67         4
           3       0.40      0.40      0.40         5
           4       0.00      0.00      0.00         5
           5       0.00      0.00      0.00         5

    accuracy                           0.35        26
   macro avg       0.22      0.40      0.28        26
weighted avg       0.20      0.35      0.25        26
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Chemical_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alcohol                   24
Ketone                    12
Fatty acid ethyl ester    11
Ester                      6
Acid                       4
Aldehyde                   2
Pyrrole                    2
Alkane                     2
Alkene                     1
Lactone                    1
Nitrile                    1
Indole                     1
Name: Chemical_class, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputed_data1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/imputed_wide.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_features1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/features_wide.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="intro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">CA4015 Assignment 2</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="automl.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Firstly, let’s load in our data and convert to CSV</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Kian Sweeney<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>